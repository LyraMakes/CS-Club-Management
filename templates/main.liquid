<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Computer Science Club Finances</title>
    <!-- meta refresh -->
    <meta http-equiv="refresh" content="10">

    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script>
        function sort(type){
            // Get the last sort type from the URL parameters
            var urlParams = new URLSearchParams(window.location.search);
            var lastSort = urlParams.get('sort');
            // If the last sort type is the same as the current sort type, reverse the sort order
            if(lastSort == null){
                window.location.href = "/?sort=" + type;
            }
            else if(lastSort == type){
                window.location.href = "/?sort=" + type + "&order=desc";
            }
            else{
                window.location.href = "/?sort=" + type;
            }
        }
    </script>
</head>
<body>
    <button onclick="window.location.href='/new/'">New Finance Record</button>
    <table class="MainTable">
        <tr>
            <th onclick="sort('id')">Item ID</th>
            <th  onclick="sort('type')">Record Type</th>
            <th  onclick="sort('creator')">Created By</th>
            <th  onclick="sort('status')">Status</th>
            <th  onclick="sort('item_count')">Items</th>
            <th  onclick="sort('total')">Total</th>
            <th>Options</th>
        </tr>
    {% for item in records %}
        <tr>
            <td style="text-align: center;">{{item.id}}</td>
            <td>{% if item.type=="invoice" %}
                Invoice
            {% else %}
                {% if item.type=="sga_budget" %}
                    SGA Budget Request
                {% else %}
                    {% if item.type=="c_invoice" %}
                        Credit Invoice
                    {% else %}
                        Other
                    {% endif %}
                {% endif %}
            {% endif %}</td>
            <td>{{item.creator}}</td>
            <td>{{item.status}}</td>
            <td>{{item.li | size}}</td>
            <td>{{item.total}}</td>
            <td><button onclick="window.open('/view/{{item.id}}')">Open</button><button onclick="window.open('/edit/{{item.id}}')">Edit</button></td>
        </tr>
    {% endfor %}
    </table>
</body>
<style>
    .MainTable{
        width: 75%
    }
    table, td, th{
        border-collapse: collapse;
        border: 1px solid black;
        text-transform: capitalize;
    }
    th{
        cursor: pointer;
    }
</style>
</html>